"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
Page({
    data: {
        URL_VIDEO_JSON: "https://a-1256136493.cos.ap-nanjing.myqcloud.com/fyhbss/data/videoXuanChuanPian.json",
        videos: [],
        ivideo: {},
        numCallback: 0,
        startX: 0,
        startY: 0,
    },
    onLoad: function () {
        this.showLoading();
        this.data.ivideo = getVideo(this.data.URL_VIDEO_JSON);
        var thiss = this;
        if (!thiss.data.ivideo.valuesCallback)
            thiss.data.ivideo.valuesCallback = function (video) {
                var _a;
                thiss.data.numCallback = ++thiss.data.numCallback;
                var len = thiss.data.videos.length;
                var tmp = 'videos[' + len + ']';
                thiss.setData((_a = {},
                    _a[tmp] = video,
                    _a));
                if (thiss.data.numCallback == thiss.data.ivideo.values.length) {
                    thiss.hideLoading();
                }
            };
        thiss.data.ivideo();
    },
    onPullDownRefresh: function () {
        this.setData({
            videos: [],
            numCallback: 0
        });
        this.onLoad();
    },
    touchStart: function (e) {
        this.setData({
            startX: e.changedTouches[0].clientX,
            startY: e.changedTouches[0].clientY,
        });
    },
    touchEnd: function (e) {
        var endX = e.changedTouches[0].clientX;
        var endY = e.changedTouches[0].clientY;
        slide(endX, endY, this.data.startX, this.data.startY, "/pages/video1/video");
    },
    showLoading: function () {
        wx.showNavigationBarLoading();
        wx.showLoading({
            title: '刷新中...',
        });
    },
    hideLoading: function () {
        wx.hideLoading();
        wx.hideNavigationBarLoading();
        wx.stopPullDownRefresh();
    },
    onReady: function () {
    },
    onShow: function () { },
    onHide: function () { },
    onUnload: function () {
    },
});
var Video = (function () {
    function Video(vid, type, name, valueCallback) {
        this.vid = vid;
        this.type = type;
        this.name = name;
        this.valueCallback = valueCallback;
        this.convertVidToUrl();
    }
    Video.prototype.convertVidToUrl = function () {
        var that = this;
        wx.request({
            url: 'https://vv.video.qq.com/getinfo',
            data: {
                vids: that.vid,
                platform: 101001,
                charge: 0,
                otype: 'json'
            },
            header: {
                'content-type': 'application/json;charset=UTF-8'
            },
            method: 'GET',
            dataType: 'json',
            success: function (res) {
                var str = res.data;
                var url = str.match(/(?<=\[{"url":").*?(?=","vt")/);
                var urll = url ? url[0] : '';
                var fn = str.match(/(?<=,"fn":").*?(?=","fs")/);
                var fnn = fn ? fn[0] : '';
                var fvkey = str.match(/(?<=,"fvkey":").*?(?=","head")/);
                var fvkeyy = fvkey ? fvkey : '';
                var src = urll + fnn + "?vkey=" + fvkeyy;
                that.src = src;
                that.valueCallback(that);
            },
            fail: function (res) {
                console.log(that.name + ' 转换视频vid时错误：' + res.errMsg);
            }
        });
    };
    return Video;
}());
exports.Video = Video;
;
;
function getVideo(URLVideoJSON) {
    var func = function () {
        wx.request({
            url: URLVideoJSON,
            success: function (res) {
                var vs = res.data;
                func.values = new Array(vs.length);
                for (var i = 0; i < vs.length; i++)
                    func.values[i] = new Video(vs[i].vid, vs[i].type, vs[i].name, func.valuesCallback);
            },
            fail: function (res) {
                console.log('视频请求网络连接错误： ' + res.errMsg);
            }
        });
    };
    return func;
}
exports.getVideo = getVideo;
;
function slide(endX, endY, startX, startY, currentURL) {
    var url;
    if (Math.abs(endX - startX) < Math.abs(endY - startY))
        return;
    if (endX - startX > 50) {
        if (currentURL === "/pages/video1/video")
            url = "/pages/video2/video";
        else if (currentURL === "/pages/video2/video")
            url = "/pages/about/about";
        else if (currentURL === "/pages/about/about")
            url = "/pages/ditu/ditu";
    }
    else if (endX - startX < -50) {
        if (currentURL === "/pages/video1/video")
            url = "/pages/ditu/ditu";
        else if (currentURL === "/pages/video2/video")
            url = "/pages/video1/video";
        else if (currentURL === "/pages/about/about")
            url = "/pages/video2/video";
    }
    wx.switchTab({ url: url });
}
exports.slide = slide;
;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlkZW8uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJ2aWRlby50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQVVBLElBQUksQ0FBQztJQUNILElBQUksRUFBRTtRQUNKLGNBQWMsRUFBRSxzRkFBc0Y7UUFDdEcsTUFBTSxFQUFXLEVBQUU7UUFDbkIsTUFBTSxFQUFVLEVBQUU7UUFDbEIsV0FBVyxFQUFFLENBQUM7UUFDZCxNQUFNLEVBQUUsQ0FBQztRQUNULE1BQU0sRUFBRSxDQUFDO0tBQ1Y7SUFLRCxNQUFNLEVBQU47UUFDRSxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDbkIsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7UUFFdEQsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxjQUFjO1lBQ25DLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLGNBQWMsR0FBRyxVQUFVLEtBQVk7O2dCQUN2RCxLQUFLLENBQUMsSUFBSSxDQUFDLFdBQVcsR0FBRyxFQUFFLEtBQUssQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDO2dCQUNsRCxJQUFJLEdBQUcsR0FBVyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUM7Z0JBQzNDLElBQUksR0FBRyxHQUFHLFNBQVMsR0FBRyxHQUFHLEdBQUcsR0FBRyxDQUFDO2dCQUNoQyxLQUFLLENBQUMsT0FBTztvQkFDWCxHQUFDLEdBQUcsSUFBRyxLQUFLO3dCQUNaLENBQUE7Z0JBRUYsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLFdBQVcsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxFQUFFO29CQUM3RCxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUM7aUJBQ3JCO1lBQ0gs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QXFCLENBQUM7YUFDdEUsSUFBSSxVQUFVLEtBQUssb0JBQW9CO1lBQUUsR0FBRyxHQUFHLHFCQUFxQixDQUFDO0tBQzNFO0lBQ0QsRUFBRSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0FBQzdCLENBQUM7QUF2QkQsc0JBdUJDO0FBQUEsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIEBBdXRob3I6IHlhbndlaVxyXG4gKiBARGF0ZTogMjAyMC0wNC0yNCAxMDowNjozNVxyXG4gKiBATGFzdEVkaXRvcnM6IHlhbndlaVxyXG4gKiBATGFzdEVkaXRUaW1lOiAyMDIwLTA4LTI0IDE3OjA0OjU2XHJcbiAqIEBEZXNjcmlwdGlvbiA6IOWuo+S8oOeJh+mhtemdouS7o+eggVxyXG4gKi9cclxuXHJcbi8vIGltcG9ydCB1dGlsID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL25ldFZpZGVvXCIpO1xyXG4vLyBpbXBvcnQgc2xpZGUgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvc2xpZGVcIik7Ly/liKTmlq3lt6blj7Pmu5Hliqjku6PnoIFcclxuUGFnZSh7XHJcbiAgZGF0YToge1xyXG4gICAgVVJMX1ZJREVPX0pTT046IFwiaHR0cHM6Ly9hLTEyNTYxMzY0OTMuY29zLmFwLW5hbmppbmcubXlxY2xvdWQuY29tL2Z5aGJzcy9kYXRhL3ZpZGVvWHVhbkNodWFuUGlhbi5qc29uXCIsLy/lrqPkvKDniYdqc29u5L+h5oGv5Zyw5Z2AXHJcbiAgICB2aWRlb3M6IDxWaWRlb1tdPltdLC8vVmlkZW/lr7nosaHmlbDnu4RcclxuICAgIGl2aWRlbzogPElWaWRlbz57fSwvL0lWaWRlb+exu+Wei+epuuWvueixoVxyXG4gICAgbnVtQ2FsbGJhY2s6IDAsLy/lm57osIPmrKHmlbDvvIznlKjkuo7ooajnpLrlhajpg6jovazmjaJzcmPlrozmiJDlkI7vvIzpmpDol49sb2FkaW5n5Yqo55S7XHJcbiAgICBzdGFydFg6IDAsLy/pgJrov4d4eeWdkOagh+WAvOWIpOaWreW3puWPs+a7keWKqFxyXG4gICAgc3RhcnRZOiAwLFxyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5Yqg6L29XHJcbiAgICovXHJcbiAgb25Mb2FkKCkge1xyXG4gICAgdGhpcy5zaG93TG9hZGluZygpO1xyXG4gICAgdGhpcy5kYXRhLml2aWRlbyA9IGdldFZpZGVvKHRoaXMuZGF0YS5VUkxfVklERU9fSlNPTik7Ly/kvKDpgJLlj4LmlbDvvIzojrflvpdJVmlkZW/mjqXlj6Plr7nosaHjgILkuZ/ljbPliJ3lp4vljJZpdmlkZW/lr7nosaFcclxuXHJcbiAgICBsZXQgdGhpc3MgPSB0aGlzO1xyXG4gICAgaWYgKCF0aGlzcy5kYXRhLml2aWRlby52YWx1ZXNDYWxsYmFjaykvL+WmguaenOS5i+WJjeacquWumuS5ie+8jOWImeWumuS5iUlWaWRlb+aOpeWPo+eahOWbnuiwg+WHveaVsO+8jFxyXG4gICAgICB0aGlzcy5kYXRhLml2aWRlby52YWx1ZXNDYWxsYmFjayA9IGZ1bmN0aW9uICh2aWRlbzogVmlkZW8pIHsgIC8v5a6a5LmJ5a6e546w5Zue6LCD55qE5Luj56CB77yM5Y+C5pWw5piv6L2s5YyWdmlk5Li6c3Jj55qEdmlkZW/lr7nosaEgICBcclxuICAgICAgICB0aGlzcy5kYXRhLm51bUNhbGxiYWNrID0gKyt0aGlzcy5kYXRhLm51bUNhbGxiYWNrOy8v6K6w5b2V5Zue6LCD5qyh5pWw77yM5Y2z6K6w5b2Vc3Jj6L2s5o2i5a6M5oiQ55qE5a+56LGh5pWwXHJcbiAgICAgICAgbGV0IGxlbjogTnVtYmVyID0gdGhpc3MuZGF0YS52aWRlb3MubGVuZ3RoO1xyXG4gICAgICAgIGxldCB0bXAgPSAndmlkZW9zWycgKyBsZW4gKyAnXSc7ICAvL+azqOaEj++8muS4jeaYr2ktMe+8jOaYr2nvvIzmmK/lnKjmlbDnu4TlsL7pg6jlop7liqDkuIDkuKrlhYPntKBcclxuICAgICAgICB0aGlzcy5zZXREYXRhKHtcclxuICAgICAgICAgIFt0bXBdOiB2aWRlbyAgIC8v5Yqo5oCB5aKe5Yqg5pWw57uE5Lit55qEdmlkZW/lr7nosaHvvIzmraR2aWRlb+WvueixoXNyY+W3sue7j+WujOaIkOi9rOaNouOAguWJjeerr+mhtemdouWunuaXtuWinuWKoOS4gOS4quinhumikVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGlmICh0aGlzcy5kYXRhLm51bUNhbGxiYWNrID09IHRoaXNzLmRhdGEuaXZpZGVvLnZhbHVlcy5sZW5ndGgpIHsvL+WmguaenOWvueixoXNyY+WFqOmDqOi9rOaNouWujOaIkFxyXG4gICAgICAgICAgdGhpc3MuaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICB0aGlzcy5kYXRhLml2aWRlbygpOyAvL+WQr+WKqElWaWRlb+aOpeWPo+WvueixoeeahOWfuuehgOWHveaVsO+8jOe9kee7nOivu+WPluWQhOinhumikeS/oeaBr++8jOaciee9kee7nOivt+axguW7tui/n1xyXG4gIH0sXHJcbiAgLyoqXHJcbiAgICog6aG16Z2i55u45YWz5LqL5Lu25aSE55CG5Ye95pWwLS3nm5HlkKznlKjmiLfkuIvmi4nliqjkvZxcclxuICAgKi9cclxuICBvblB1bGxEb3duUmVmcmVzaCgpIHtcclxuICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgIHZpZGVvczogPFZpZGVvW10+W10sICAgIC8v5Yid5aeL5YyWdmlkZW/lr7nosaHkuLrnqbpcclxuICAgICAgbnVtQ2FsbGJhY2s6IDAvL+WIneWni+WMluWbnuiwg+asoeaVsOS4ujBcclxuICAgIH0pXHJcbiAgICB0aGlzLm9uTG9hZCgpOy8v5YaN5qyh5ouJ5Y+W5paw5pWw5o2uXHJcbiAgfSxcclxuICAvKipcclxuICAgICAqIOmhtemdouebuOWFs+S6i+S7tuWkhOeQhuWHveaVsC0t55uR5ZCs55So5oi35ruR5Yqo5byA5aeLXHJcbiAgICAgKi9cclxuICB0b3VjaFN0YXJ0KGU6IGFueSkge1xyXG4gICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgc3RhcnRYOiBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFgsXHJcbiAgICAgIHN0YXJ0WTogZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZLFxyXG4gICAgfSlcclxuICB9LFxyXG4gIC8qKlxyXG4gICAqIOmhtemdouebuOWFs+S6i+S7tuWkhOeQhuWHveaVsC0t55uR5ZCs55So5oi35ruR5Yqo57uT5p2fXHJcbiAgICovXHJcbiAgdG91Y2hFbmQoZTogYW55KSB7XHJcbiAgICBsZXQgZW5kWCA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WDtcclxuICAgIGxldCBlbmRZID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZO1xyXG4gICAgc2xpZGUoZW5kWCwgZW5kWSwgdGhpcy5kYXRhLnN0YXJ0WCwgdGhpcy5kYXRhLnN0YXJ0WSxcIi9wYWdlcy92aWRlbzEvdmlkZW9cIik7IFxyXG4gIH0sXHJcbiAgLyoqXHJcbiog5pi+56S65Yqg6L295Yqo55S7XHJcbiovXHJcbiAgc2hvd0xvYWRpbmcoKSB7XHJcbiAgICB3eC5zaG93TmF2aWdhdGlvbkJhckxvYWRpbmcoKTsvL+WcqOW9k+WJjemhtemdouaYvuekuuWvvOiIquadoeWKoOi9veWKqOeUuyAgICBcclxuICAgIHd4LnNob3dMb2FkaW5nKHsvL+aYvuekuiBsb2FkaW5nIOaPkOekuuahhuOAgumcgOS4u+WKqOiwg+eUqCB3eC5oaWRlTG9hZGluZyDmiY3og73lhbPpl63mj5DnpLrmoYZcclxuICAgICAgdGl0bGU6ICfliLfmlrDkuK0uLi4nLFxyXG4gICAgfSlcclxuICB9LFxyXG4gIC8qKlxyXG4gICog6ZqQ6JeP5Yqg6L295Yqo55S7XHJcbiAgKi9cclxuICBoaWRlTG9hZGluZygpIHtcclxuICAgIHd4LmhpZGVMb2FkaW5nKCk7Ly/pmpDol49sb2FkaW5nIOaPkOekuuahhiAgICAgICAgIFxyXG4gICAgd3guaGlkZU5hdmlnYXRpb25CYXJMb2FkaW5nKCk7IC8v6ZqQ6JeP5a+86Iiq5p2h5Yqg6L295Yqo55S7ICAgICAgICAgXHJcbiAgICB3eC5zdG9wUHVsbERvd25SZWZyZXNoKCk7IC8v5YGc5q2i5LiL5ouJ5Yi3XHJcbiAgfSxcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5Yid5qyh5riy5p+T5a6M5oiQXHJcbiAgICovXHJcbiAgb25SZWFkeSgpIHtcclxuICAgIC8vY29uc29sZS5sb2coJ29ucmVhZHknKVxyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIOeUn+WRveWRqOacn+WHveaVsC0t55uR5ZCs6aG16Z2i5pi+56S6XHJcbiAgICovXHJcbiAgb25TaG93KCkgeyB9LFxyXG5cclxuICAvKipcclxuICAgKiDnlJ/lkb3lkajmnJ/lh73mlbAtLeebkeWQrOmhtemdoumakOiXj1xyXG4gICAqL1xyXG4gIG9uSGlkZSgpIHsgfSxcclxuXHJcbiAgLyoqXHJcbiAgICog55Sf5ZG95ZGo5pyf5Ye95pWwLS3nm5HlkKzpobXpnaLljbjovb1cclxuICAgKi9cclxuICBvblVubG9hZCgpIHtcclxuICAgIC8vIGNsZWFySW50ZXJ2YWwodGhpcy5kYXRhLnRpbWVyKVxyXG4gIH0sXHJcblxyXG59KTtcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIOW+heaooeWdl+WMluS7o+eggSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBWaWRlbyB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/ohb7orq/op4bpopHnsbtcclxuICB2aWQ6IHN0cmluZzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v6IW+6K6v6KeG6aKRdmlkXHJcbiAgdHlwZTogc3RyaW5nOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v57G75Z6LXHJcbiAgbmFtZTogc3RyaW5nOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lkI3np7BcclxuICBzcmM/OiBzdHJpbmc7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v6IW+6K6v6KeG6aKR5a6e6ZmF572R57uc5Zyw5Z2AICBcclxuICB2YWx1ZUNhbGxiYWNrPzogKHZhbHVlOiBWaWRlbykgPT4gdm9pZDsgICAgICAgICAgICAgIC8v5Y+v6YCJ55qE5Zue6LCD5pa55rOV77yMICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gIGNvbnN0cnVjdG9yKHZpZDogc3RyaW5nLCB0eXBlOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgdmFsdWVDYWxsYmFjaz86ICh2YWx1ZTogVmlkZW8pID0+IHZvaWQpIHtcclxuICAgIHRoaXMudmlkID0gdmlkO1xyXG4gICAgdGhpcy50eXBlID0gdHlwZTtcclxuICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLnZhbHVlQ2FsbGJhY2sgPSB2YWx1ZUNhbGxiYWNrO1xyXG4gICAgdGhpcy5jb252ZXJ0VmlkVG9VcmwoKTsvL+WcqOWIneWni+WMluWvueixoeaXtu+8jOiBlOe9kei9rOWMlnZpZFxyXG4gIH1cclxuICBjb252ZXJ0VmlkVG9VcmwoKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/lsIZ2aWTovazmjaLkuLpVUkws5pyJ572R57uc6K+35rGC5bu26L+fXHJcbiAgICBsZXQgdGhhdCA9IHRoaXNcclxuICAgIHd4LnJlcXVlc3Qoe1xyXG4gICAgICB1cmw6ICdodHRwczovL3Z2LnZpZGVvLnFxLmNvbS9nZXRpbmZvJyxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIHZpZHM6IHRoYXQudmlkLFxyXG4gICAgICAgIHBsYXRmb3JtOiAxMDEwMDEsXHJcbiAgICAgICAgY2hhcmdlOiAwLFxyXG4gICAgICAgIG90eXBlOiAnanNvbidcclxuICAgICAgfSxcclxuICAgICAgaGVhZGVyOiB7XHJcbiAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9VVRGLTgnIC8vIOm7mOiupOWAvFxyXG4gICAgICB9LFxyXG4gICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4gICAgICBzdWNjZXNzKHJlcykge1xyXG4gICAgICAgIGxldCBzdHI6IHN0cmluZyA9IHJlcy5kYXRhIGFzIHN0cmluZztcclxuICAgICAgICAvL+eUqOato+WImeihqOi+vuW8j1xyXG4gICAgICAgIGxldCB1cmwgPSBzdHIubWF0Y2goLyg/PD1cXFt7XCJ1cmxcIjpcIikuKj8oPz1cIixcInZ0XCIpLyk7XHJcbiAgICAgICAgbGV0IHVybGwgPSB1cmwgPyB1cmxbMF0gOiAnJztcclxuICAgICAgICBsZXQgZm4gPSBzdHIubWF0Y2goLyg/PD0sXCJmblwiOlwiKS4qPyg/PVwiLFwiZnNcIikvKTtcclxuICAgICAgICBsZXQgZm5uID0gZm4gPyBmblswXSA6ICcnO1xyXG4gICAgICAgIGxldCBmdmtleSA9IHN0ci5tYXRjaCgvKD88PSxcImZ2a2V5XCI6XCIpLio/KD89XCIsXCJoZWFkXCIpLyk7XHJcbiAgICAgICAgbGV0IGZ2a2V5eSA9IGZ2a2V5ID8gZnZrZXkgOiAnJztcclxuICAgICAgICAvL+inhOW+i3VybCArIGZuICsgJz92a2V5PScgKyBmdmtleSBcclxuICAgICAgICBsZXQgc3JjID0gdXJsbCArIGZubiArIFwiP3ZrZXk9XCIgKyBmdmtleXk7XHJcbiAgICAgICAgdGhhdC5zcmMgPSBzcmM7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyhzcmMpXHJcbiAgICAgICAgdGhhdC52YWx1ZUNhbGxiYWNrISh0aGF0KTsvL++8geihqOekuuW3sue7j+WIneWni+WMlu+8jOWbnuiwg+WtmOWcqOOAguS8oOmAkuacrHZpZGVv5a+56LGhXHJcbiAgICAgIH0sXHJcbiAgICAgIGZhaWwocmVzKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhhdC5uYW1lICsgJyDovazmjaLop4bpopF2aWTml7bplJnor6/vvJonICsgcmVzLmVyck1zZylcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJVmlkZW8geyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mt7flkIjnsbvlnovnmoTmjqXlj6PvvIzop4bpopHmjqXlj6NcclxuICAoKTogdm9pZDsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+aOpeWPo+eahOWfuuehgOaWueazlVxyXG4gIHZhbHVlczogVmlkZW9bXTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8v6KeG6aKR5pWw57uE77yM55Sx5Z+656GA5pa55rOV5LuO572R57uc6K+35rGC5pWw5o2uXHJcbiAgdmFsdWVzQ2FsbGJhY2s/OiAodmlkZW86IFZpZGVvKSA9PiB2b2lkOyAgICAgICAgICAgLy/lj6/pgInnmoTmjqXlj6PnmoTlm57osIPmlrnms5XvvIxcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRWaWRlbyhVUkxWaWRlb0pTT046IHN0cmluZyk6IElWaWRlbyB7ICAgIC8v5o6l5Y+j5a6e546w77yM5LuF5a6e546w5LqG5Z+656GA5pa55rOV5Luj56CB77yM5pyq5a6e546w5Zue6LCD5pa55rOV77yMXHJcbiAgbGV0IGZ1bmMgPSA8SVZpZGVvPmZ1bmN0aW9uICgpIHtcclxuICAgIHd4LnJlcXVlc3QoeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+e9kee7nOivt+axguWPluaVsOaNrlxyXG4gICAgICB1cmw6IFVSTFZpZGVvSlNPTiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL+eugOWNleWcsOWbvuagh+iusOeCuWpzb27mlofku7bnmoTnvZHnu5zlnLDlnYBcclxuICAgICAgc3VjY2VzcyhyZXMpIHtcclxuICAgICAgICBsZXQgdnMgPSA8VmlkZW9bXT5yZXMuZGF0YTsgICAgICAgICAgICAgICAgICAgLy90eXBlc2NyaXB06Ieq5Yqo6KOF6YWN77yM5YW25LuW5L+h5oGv6YO95a2Y5Zyo77yM5LuFc3Jj5Li656m677yM5L2G5LiN5ZCv5Yqo6KeG6aKR57G755qE5p6E5bu65Zmo77yM6ZyA6KaB5Lq65belbmV35a+56LGhXHJcblxyXG4gICAgICAgIGZ1bmMudmFsdWVzID0gbmV3IEFycmF5KHZzLmxlbmd0aCk7ICAgICAgICAgICAvL+eUn+aIkOWbuuWumumVv+W6puinhumikeWvueixoSAgIFxyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHZzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgZnVuYy52YWx1ZXNbaV0gPSBuZXcgVmlkZW8odnNbaV0udmlkLCB2c1tpXS50eXBlLCB2c1tpXS5uYW1lLCBmdW5jLnZhbHVlc0NhbGxiYWNrKTsvL+S6uuW3pW5ld+Wvueixoe+8jOWQr+WKqOaehOW7uuWZqO+8jOe9kee7nOaLieWPluaVsOaNrui9rOWMlnZpZOS4unNyY1xyXG4gICAgICB9LFxyXG4gICAgICBmYWlsKHJlcykge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCfop4bpopHor7fmsYLnvZHnu5zov57mjqXplJnor6/vvJogJyArIHJlcy5lcnJNc2cpXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH07XHJcbiAgcmV0dXJuIGZ1bmM7XHJcbn07XHJcblxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNsaWRlICAoXHJcbiAgZW5kWDogbnVtYmVyLFxyXG4gIGVuZFk6IG51bWJlcixcclxuICBzdGFydFg6IG51bWJlcixcclxuICBzdGFydFk6IG51bWJlcixcclxuICBjdXJyZW50VVJMOiBzdHJpbmdcclxuKSB7XHJcbiAgbGV0IHVybCE6IHN0cmluZzsgLy/ljbPlsIbot7PovaznmoR0YWLpobXpnaLlnLDlnYBcclxuXHJcbiAgaWYgKE1hdGguYWJzKGVuZFggLSBzdGFydFgpIDwgTWF0aC5hYnMoZW5kWSAtIHN0YXJ0WSkpXHJcbiAgICAvL+S/neivgSDmqKrlkJHmu5HliqggPiDnurXlkJHmu5HliqhcclxuICAgIHJldHVybjtcclxuXHJcbiAgaWYgKGVuZFggLSBzdGFydFggPiA1MCkgeyAgICAvL+WPs+a7kVxyXG4gICAgaWYgKGN1cnJlbnRVUkwgPT09IFwiL3BhZ2VzL3ZpZGVvMS92aWRlb1wiKSB1cmwgPSBcIi9wYWdlcy92aWRlbzIvdmlkZW9cIjtcclxuICAgIGVsc2UgaWYgKGN1cnJlbnRVUkwgPT09IFwiL3BhZ2VzL3ZpZGVvMi92aWRlb1wiKSB1cmwgPSBcIi9wYWdlcy9hYm91dC9hYm91dFwiO1xyXG4gICAgZWxzZSBpZiAoY3VycmVudFVSTCA9PT0gXCIvcGFnZXMvYWJvdXQvYWJvdXRcIikgdXJsID0gXCIvcGFnZXMvZGl0dS9kaXR1XCI7XHJcbiAgfSBlbHNlIGlmIChlbmRYIC0gc3RhcnRYIDwgLTUwKSB7ICAgIC8v5bem5ruRXHJcbiAgICBpZiAoY3VycmVudFVSTCA9PT0gXCIvcGFnZXMvdmlkZW8xL3ZpZGVvXCIpIHVybCA9IFwiL3BhZ2VzL2RpdHUvZGl0dVwiO1xyXG4gICAgZWxzZSBpZiAoY3VycmVudFVSTCA9PT0gXCIvcGFnZXMvdmlkZW8yL3ZpZGVvXCIpIHVybCA9IFwiL3BhZ2VzL3ZpZGVvMS92aWRlb1wiO1xyXG4gICAgZWxzZSBpZiAoY3VycmVudFVSTCA9PT0gXCIvcGFnZXMvYWJvdXQvYWJvdXRcIikgdXJsID0gXCIvcGFnZXMvdmlkZW8yL3ZpZGVvXCI7XHJcbiAgfVxyXG4gIHd4LnN3aXRjaFRhYih7IHVybDogdXJsIH0pO1xyXG59O1xyXG4iXX0=